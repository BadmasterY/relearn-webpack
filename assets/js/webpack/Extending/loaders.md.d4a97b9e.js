(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{145:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return u}));var t,c=n(85),s=(n(127),n(0),n(86));function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,r,m=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",a)}},N=m("MdAlert"),l={};function u(e){var a=e.components,n=o(e,["components"]);return Object(s.b)("wrapper",p({},l,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h2",{className:"__internal",id:"用加载器扩展"},"用加载器扩展",Object(s.b)("a",p({parentName:"h2"},{href:"#%E7%94%A8%E5%8A%A0%E8%BD%BD%E5%99%A8%E6%89%A9%E5%B1%95","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"到目前为止, 正如您所见的那样, 加载器是 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的组成部分之一。如果要加载资源, 则很可能需要设置匹配的加载器定义。即使有",Object(s.b)("a",p({parentName:"p"},{href:"https://webpack.js.org/loaders/",target:"_blank"}),"很多可用的加载器"),", 但依旧有可能找不到任何适用于当前项目的加载器。"),Object(s.b)("p",null,"接下来, 您将学习开发几个小型加载器。但是在此之前, 最好了解如何单独调试它们。"),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果您想为加载器或插件提供好的起点, 请考虑使用 ",Object(s.b)("a",p({parentName:"p"},{href:"https://github.com/webpack-contrib/webpack-defaults",target:"_blank"}),"webpack-defaults"),", 它为 ",Object(s.b)("inlineCode",{parentName:"p"},"linting"),"、测试和其他好的工具提供了基本的起点。")),Object(s.b)("h3",{className:"__internal",id:"使用-loader-runner-调试加载器"},"使用 loader-runner 调试加载器",Object(s.b)("a",p({parentName:"h3"},{href:"#%E4%BD%BF%E7%94%A8-loader-runner-%E8%B0%83%E8%AF%95%E5%8A%A0%E8%BD%BD%E5%99%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/loader-runner",target:"_blank"}),"loader-runner")," 允许您在没有 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的情况下运行加载器, 从而使您可以了解有关加载器开发的更多信息。首先进行安装:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," loader-runner --develop"))),Object(s.b)("p",null,"若要进行测试, 需要设置一个加载器, 该加载器返回传递给它的值的两倍:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),"module",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"input"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," input ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"+")," input",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"设置要处理的文件:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"demo.txt")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"txt"},Object(s.b)("pre",p({parentName:"div"},{className:"language-txt"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-txt"}),"foobar"))),Object(s.b)("p",null,"代码中还没有特定于 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的东西。下一步是通过 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"loader-runner"))," 运行加载器:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"run-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," fs ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"fs"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," path ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"path"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," runLoaders ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"loader-runner"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"runLoaders"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    resource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./demo.txt"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    loaders",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"path",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"resolve"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"__dirname",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./loaders/demo-loader"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    readResource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"readFile"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"bind"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"err",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," result"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"?")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"error"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"log"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"result",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"如果现在运行脚本(",Object(s.b)("inlineCode",{parentName:"p"},"node run-loader.js"),"), 应该会看到输出:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  result: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),"'foobar",Object(s.b)("span",p({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),"foobar",Object(s.b)("span",p({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),"'")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  resourceBuffer: ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"<"),"Buffer ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"66")," 6f 6f ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"62")," ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"61")," ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"72")," 0a",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),">"),",\n  cacheable: true,\n  fileDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),"'./demo.txt'")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  contextDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  missingDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},Object(s.b)("strong",{parentName:"p"},"BTW"),": ",Object(s.b)("inlineCode",{parentName:"p"},"result")," 内的 ",Object(s.b)("inlineCode",{parentName:"p"},"\\n")," 为尾部换行导致。如果不换行:",Object(s.b)("br",{parentName:"p"}),"\n","result: ","[ 'foobarfoobar' ]",Object(s.b)("br",{parentName:"p"}),"\n","resourceBuffer: <Buffer 66 6f 6f 62 61 72>",Object(s.b)("br",{parentName:"p"}),"\n","......")),Object(s.b)("p",null,"输出告诉处理的 ",Object(s.b)("inlineCode",{parentName:"p"},"result"),"、作为缓冲区处理的资源和其他元信息。这些数据足以开发出更复杂的加载器。"),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果要将输出写入文件, 请使用 ",Object(s.b)("inlineCode",{parentName:"p"},'fs.writeFileSync("./output.txt", result.result)')," 或其异步版本, 如 ",Object(s.b)("a",p({parentName:"p"},{href:"https://nodejs.org/api/fs.html",target:"_blank"}),"Node 文档中所述"),"。")),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"可以通过名称引用安装到本地项目的加载器, 而不用解析它们的完整路径。例如: ",Object(s.b)("inlineCode",{parentName:"p"},'loaders: ["raw-loader"]'),"。")),Object(s.b)("h3",{className:"__internal",id:"实现异步加载器"},"实现异步加载器",Object(s.b)("a",p({parentName:"h3"},{href:"#%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E5%99%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"即使您可以使用同步接口实现许多加载器, 但有时仍需要进行异步计算。将第三方软件包包装为加载器时, 可能会迫使您这样做。"),Object(s.b)("p",null,"通过使用 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 特定的 ",Object(s.b)("inlineCode",{parentName:"p"},"API")," ",Object(s.b)("mark",null,"this.async()"),", 可以将上述示例调整为异步形式。",Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 对 ",Object(s.b)("inlineCode",{parentName:"p"},"this")," 进行设置, 然后函数按照 ",Object(s.b)("inlineCode",{parentName:"p"},"Node")," 约定返回一个回调函数(错误优先)。"),Object(s.b)("p",null,"进行如下调整:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),"module",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"input"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," callback ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"async"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// No callback -> return synchronous results"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// if (callback) { ... }"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"callback"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"null"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," input ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"+")," input",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)(N,p({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"鉴于 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 通过 ",Object(s.b)("inlineCode",{parentName:"p"},"API")," 为其注入其 ",Object(s.b)("inlineCode",{parentName:"p"},"this"),", 所以此处不能使用箭头函数(",Object(s.b)("inlineCode",{parentName:"p"},"() => ..."),")。")),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果要将 ",Object(s.b)("inlineCode",{parentName:"p"},"source map")," 传递到 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack"),", 请将其作为回调的第三个参数。")),Object(s.b)("p",null,"再次运行演示脚本(",Object(s.b)("inlineCode",{parentName:"p"},"node run-loader.js"),"), 其结果应与之前相同。要在执行期间引发错误, 请尝试以下操作:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),"module",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"input"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," callback ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"async"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"callback"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"new")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"Error"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"Demo error"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"结果应包含 ",Object(s.b)("inlineCode",{parentName:"p"},"Error: Demo error")," 相关的堆栈跟踪信息, 以显示错误产生的位置。"),Object(s.b)("h3",{className:"__internal",id:"仅返回输出"},"仅返回输出",Object(s.b)("a",p({parentName:"h3"},{href:"#%E4%BB%85%E8%BF%94%E5%9B%9E%E8%BE%93%E5%87%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"加载器也可用于仅返回输出。代码实现如下:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),"module",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"foobar"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"但有什么意义呢? 您可以通过 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 入口传递给加载器。在大多数情况下, 入口都是指向一些已经存在的文件, 而这种方式使您可以动态生成代码的加载器。"),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果要返回 ",Object(s.b)("inlineCode",{parentName:"p"},"Buffer")," 输出, 请设置 ",Object(s.b)("inlineCode",{parentName:"p"},"module.exports.raw = true"),"。该标志将覆盖默认返回一个字符串的行为。")),Object(s.b)("h3",{className:"__internal",id:"写文件"},"写文件",Object(s.b)("a",p({parentName:"h3"},{href:"#%E5%86%99%E6%96%87%E4%BB%B6","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"诸如 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"file-loader"))," 之类的加载器会产出文件。",Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 为此提供了一种方法 ",Object(s.b)("inlineCode",{parentName:"p"},"this.emitFile"),"。鉴于 ",Object(s.b)("inlineCode",{parentName:"p"},"loader-runner")," 没有实现该方法, 您必须对其进行模拟:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"run-loader.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"runLoaders"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    resource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./demo.txt"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    loaders",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"path",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"resolve"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"__dirname",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./loaders/demo-loader"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    context",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      ",Object(s.b)("span",p({parentName:"span"},{className:"token function-variable function"}),"emitFile"),Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),"\n    readResource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"readFile"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"bind"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"err",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," result"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"?")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"error"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"log"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"result",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"要实现 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"file-loader"))," 的基本思想, 您必须做两件事: 产出文件并返回文件的路径。"),Object(s.b)("p",null,"要插入文件名, 需要使用 ",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/loader-utils",target:"_blank"}),"loader-utils"),"。它还具有解析加载程序选项和查询功能的实用程序。安装它:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," loader-utils --develop"))),Object(s.b)("p",null,"您可以应用以下逻辑:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," loaderUtils ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"loader-utils"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"content"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," url ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," loaderUtils",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"interpolateName"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"[hash].[ext]"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"emitFile"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"url",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," path ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token template-string"}),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`"),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"__webpack_public_path__ + "),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),Object(s.b)("span",p({parentName:"span"},{className:"token constant"}),"JSON"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"stringify"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"url",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),";"),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," ",Object(s.b)("span",p({parentName:"code"},{className:"token template-string"}),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`"),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"export default "),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),"path",Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 提供了两种额外的 ",Object(s.b)("inlineCode",{parentName:"p"},"emit")," 方法:"),Object(s.b)("ul",null,Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),Object(s.b)("inlineCode",{parentName:"li"},"this.emitWarning(<string>)")),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),Object(s.b)("inlineCode",{parentName:"li"},"this.emitError(<string>)"))),Object(s.b)("p",null,"我们也可以使用 ",Object(s.b)("inlineCode",{parentName:"p"},"console")," 中的相关方法来替代它们。与 ",Object(s.b)("inlineCode",{parentName:"p"},"this.emitFile")," 一样, 您必须模拟它们才能在 ",Object(s.b)("inlineCode",{parentName:"p"},"loader-runner")," 中工作。"),Object(s.b)("p",null,"下一个问题是如何将文件名传递给加载器。"),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},Object(s.b)("inlineCode",{parentName:"p"},"loader-utils")," 包含插入文件名之外的实用程序。一个很好的例子是 ",Object(s.b)("inlineCode",{parentName:"p"},"loaderUtils.parseQuery(this.resourceQuery)"),", 它允许您解析传递给加载程序的查询参数, 并以另一种方式控制它的行为。")),Object(s.b)("h3",{className:"__internal",id:"将-options-传递给加载器"},"将 options 传递给加载器",Object(s.b)("a",p({parentName:"h3"},{href:"#%E5%B0%86-options-%E4%BC%A0%E9%80%92%E7%BB%99%E5%8A%A0%E8%BD%BD%E5%99%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"为了演示如何传递 ",Object(s.b)("inlineCode",{parentName:"p"},"options"),", 需要做一些小调整:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"run-loader.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," fs ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"fs"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," path ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"path"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," runLoaders ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"loader-runner"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"runLoaders"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    resource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./demo.txt"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),'// loaders: [path.resolve(__dirname, "./loaders/demo-loader")],')),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    loaders",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"[")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"        loader",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," path",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"resolve"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"__dirname",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"span"},{className:"token string"}),'"./loaders/demo-loader"'),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"        options",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"          name",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token string"}),'"demo.[ext]"'),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"        ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),"\n    context",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"emitFile"),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    readResource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"readFile"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"bind"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"fs",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"err",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," result"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"?")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"error"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"log"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"result",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"要将其连接到加载器, 请将其设置为捕获 ",Object(s.b)("inlineCode",{parentName:"p"},"name")," 并通过 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的插值器传递:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/demo-loader.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," loaderUtils ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"loader-utils"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"content"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),'// const url = loaderUtils.interpolateName(this, "[hash].[ext]", {')),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"//   content,")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// });")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"const")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," name ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," loaderUtils",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"getOptions"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"const")," url ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," loaderUtils",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"interpolateName"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," name",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," content ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"运行(",Object(s.b)("inlineCode",{parentName:"p"},"node ./run-loader.js"),")后, 您应该会看到以下内容:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," result: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),"'export default __webpack_public_path__+\"demo.txt\";'")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  resourceBuffer: ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"<"),"Buffer ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"66")," 6f 6f ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"62")," ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"61")," ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"72")," 0a",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),">"),",\n  cacheable: true,\n  fileDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),"'./demo.txt'")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  contextDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("p",null,"您可以看到结果与加载器应返回的结果匹配。您可以尝试将更多选项传递给加载器, 或使用查询参数来查看不同组合会发生什么。"),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"验证选项是个好主意, 如果选项不是您所期望的, 那么就不应该默默地失败。",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/schema-utils",target:"_blank"}),"schema-utils")," 就是为此目的而设计的。")),Object(s.b)("h3",{className:"__internal",id:"将自定义加载器与-webpack-连接"},"将自定义加载器与 webpack 连接",Object(s.b)("a",p({parentName:"h3"},{href:"#%E5%B0%86%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%8E-webpack-%E8%BF%9E%E6%8E%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"为了充分利用加载器, 您必须将它们与 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 连接。为此, 可以使用 ",Object(s.b)("inlineCode",{parentName:"p"},"import"),":",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"src/component.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"import")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"!../loaders/demo-loader?name=foo!./main.css"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"鉴于定义过于冗长, 因此可以使用以下别名作为加载器的别名:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"webpack.config.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," commonConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    resolveLoader",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      alias",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"        ",Object(s.b)("span",p({parentName:"span"},{className:"token string"}),'"demo-loader"'),Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," path",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"resolve"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"(")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"          __dirname",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"          ",Object(s.b)("span",p({parentName:"span"},{className:"token string"}),'"loaders/demo-loader.js"')),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"        ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"通过此更改, 可以简化 ",Object(s.b)("inlineCode",{parentName:"p"},"import")," 定义:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),'// import "!../loaders/demo-loader?name=foo!./main.css";'),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"import")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"!demo-loader?name=foo!./main.css"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"您还可以通过 ",Object(s.b)("inlineCode",{parentName:"p"},"rules")," 来处理加载器定义。一旦加载器足够稳定, 就可以基于 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack-defaults")," 设置一个项目, 然后将加载器逻辑添加在其中, 然后将加载器作为软件包使用。"),Object(s.b)(N,p({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"尽管使用 ",Object(s.b)("inlineCode",{parentName:"p"},"loader-runner")," 可以方便地开发和测试加载器, 但是请实施针对 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 进行集成测试。环境之间的细微差异使这一点变得至关重要。")),Object(s.b)("h3",{className:"__internal",id:"pitch-loaders"},"Pitch loaders",Object(s.b)("a",p({parentName:"h3"},{href:"#pitch-loaders","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,Object(s.b)("img",p({parentName:"p"},{src:"../../extending/pitch-loaders.webp",alt:"Webpack 加载程序处理"}))),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 评估分为两个阶段: ",Object(s.b)("inlineCode",{parentName:"p"},"pitching")," 和 ",Object(s.b)("inlineCode",{parentName:"p"},"evaluating"),"。如果您习惯于 ",Object(s.b)("inlineCode",{parentName:"p"},"web")," 事件语义, 那么这些将映射为捕获和冒泡。这个想法是,  ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 允许你在 ",Object(s.b)("inlineCode",{parentName:"p"},"pitching"),"(捕捉)阶段拦截执行。它首先从左到右遍历加载器, 然后从右到左执行它们。"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"pitch loader")," 使您可以调整请求甚至终止请求。设置它:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"loaders/pitch-loader.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," loaderUtils ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"loader-utils"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"input"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," input ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"+")," loaderUtils",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"getOptions"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"text",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"exports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"pitch")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"remainingReq",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),","),"\n  precedingReq",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),","),"\n  input"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"log"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token template-string"}),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`"),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"\nRemaining request: "),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),"remainingReq",Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"\nPreceding request: "),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),"precedingReq",Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"\nInput: "),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"${"),Object(s.b)("span",p({parentName:"span"},{className:"token constant"}),"JSON"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"stringify"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"input",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"null"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"span"},{className:"token number"}),"2"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token interpolation-punctuation punctuation"}),"}")),Object(s.b)("span",p({parentName:"span"},{className:"token string"}),"\n  "),Object(s.b)("span",p({parentName:"span"},{className:"token template-punctuation string"}),"`")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"pitched"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"要将其连接到 ",Object(s.b)("inlineCode",{parentName:"p"},"run-loader.js"),", 请将其添加到 ",Object(s.b)("inlineCode",{parentName:"p"},"loader")," 定义中。修改如下:",Object(s.b)("br",{parentName:"p"}),"\n",Object(s.b)("strong",{parentName:"p"},"run-loader.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"runLoaders"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    resource",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./demo.txt"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    loaders",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      path",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"resolve"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"__dirname",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"span"},{className:"token string"}),'"./loaders/pitch-loader"'),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"err",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," result"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"?")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"error"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," console",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"log"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"result",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"如果您现在运行(",Object(s.b)("inlineCode",{parentName:"p"},"node ./run-loader.js"),"), 则 ",Object(s.b)("inlineCode",{parentName:"p"},"pitch loader")," 应记录中间数据并拦截执行:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),"Remaining request: ./demo.txt\nPreceding request: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),".."),"./webpack-demo/loaders/demo-loader?",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"name"'),Object(s.b)("span",p({parentName:"code"},{className:"token builtin class-name"}),":"),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"demo.[ext]"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),"\nInput: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," result: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),"'export default __webpack_public_path__ + \"demo.txt\";'")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  resourceBuffer: null,\n  cacheable: true,\n  fileDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),",\n  contextDependencies: ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)(N,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"在",Object(s.b)("a",p({parentName:"p"},{href:"https://webpack.js.org/api/loaders/",target:"_blank"}),"官方文档"),"详细地介绍了加载器 ",Object(s.b)("inlineCode",{parentName:"p"},"API"),"。您可以在那里查看所有 ",Object(s.b)("inlineCode",{parentName:"p"},"this")," 可用字段。例如, ",Object(s.b)("inlineCode",{parentName:"p"},"mode")," 是公开的。")),Object(s.b)("h3",{className:"__internal",id:"用加载器缓存"},"用加载器缓存",Object(s.b)("a",p({parentName:"h3"},{href:"#%E7%94%A8%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BC%93%E5%AD%98","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"尽管 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 默认情况下会缓存加载器, 除非设置了 ",Object(s.b)("inlineCode",{parentName:"p"},"this.cacheable(false)"),", 但编写缓存加载器可能是一个不错的练习, 因为它可以帮助您了解加载器阶段如何协同工作。下面的示例显示了如何实现这一目标(由 Vladimir Grenaderov 提供):"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," cache ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"new")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"Map"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"exports")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"content"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Calls only once for given resourcePath"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," callbacks ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," cache",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"get"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"resourcePath",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n  callbacks",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"forEach"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"callback"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"callback"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"null"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n  cache",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"set"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"resourcePath",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\nmodule",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"exports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"pitch")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"cache",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"has"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"resourcePath",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," item ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," cache",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"get"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"resourcePath",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"item ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"instanceof")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"Array"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      item",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"push"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"async"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Load to cache"),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"else")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," item",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Hit cache"),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"else")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    cache",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"set"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"this"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"resourcePath",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Missed cache"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"可以使用 ",Object(s.b)("inlineCode",{parentName:"p"},"pitch loader")," 将元数据附加到输入以供以后使用。在这个例子中, 缓存是在提交阶段构建的, 并且在正常执行期间被访问。"),Object(s.b)("h3",{className:"__internal",id:"结论"},"结论",Object(s.b)("a",p({parentName:"h3"},{href:"#%E7%BB%93%E8%AE%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"编写加载程序很有趣, 因为它们描述了从一种格式到另一种格式的转换。通常, 您可以通过研究 ",Object(s.b)("inlineCode",{parentName:"p"},"API")," 文档或现有的加载程序来弄清楚如何实现特定的功能。"),Object(s.b)("p",null,"回顾一下:"),Object(s.b)("ul",null,Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),Object(s.b)("inlineCode",{parentName:"li"},"loader-runner")," 是了解加载器工作方式的宝贵工具。用它来调试加载器的工作方式。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),Object(s.b)("inlineCode",{parentName:"li"},"Webpack")," 加载器接受输入并根据输入产生输出。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"加载器可以是同步的也可以是异步的。在后一种情况下, 您应该使用 ",Object(s.b)("inlineCode",{parentName:"li"},"webpack API")," ",Object(s.b)("inlineCode",{parentName:"li"},"this.async()")," 来捕获 ",Object(s.b)("inlineCode",{parentName:"li"},"webpack")," 公开的回调。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"如果要为 ",Object(s.b)("inlineCode",{parentName:"li"},"webpack")," 入口动态生成代码, 则可以在其中使用加载器。加载器不必接受输入。在这种情况下只返回输出是可以接受的。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"使用 ",Object(s.b)("inlineCode",{parentName:"li"},"loader-utils")," 解析传递给加载器的可能选项, 并考虑使用 ",Object(s.b)("inlineCode",{parentName:"li"},"schema-utils")," 对其进行验证。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"在本地开发装载程序时, 请考虑设置 ",Object(s.b)("inlineCode",{parentName:"li"},"aresolveLoader.alias")," 来清理引用。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),Object(s.b)("inlineCode",{parentName:"li"},"pitching")," 阶段是对默认行为的补充, 它允许您截取和附加元数据。")),Object(s.b)("p",null,"在下一章中, 您将学习编写插件。插件允许您拦截 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的执行过程, 并且可以与加载程序结合使用以开发更多高级功能。"))}u.isMDXComponent=!0,u=Object(c.hot)(e)(u),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(m,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/loaders.md"),b.register(N,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/loaders.md"),b.register(l,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/loaders.md"),b.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/loaders.md"),b.register(u,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/loaders.md")),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&r(e)}.call(this,n(21)(e))}}]);