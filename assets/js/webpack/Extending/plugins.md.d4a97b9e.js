(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{146:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return i}));var t,c=n(85),p=(n(127),n(0),n(86));function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},p=Object.keys(e);for(t=0;t<p.length;t++)n=p[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(t=0;t<p.length;t++)n=p[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,m,r=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(p.b)("div",a)}},l=r("MdAlert"),N={};function i(e){var a=e.components,n=o(e,["components"]);return Object(p.b)("wrapper",s({},N,n,{components:a,mdxType:"MDXLayout"}),Object(p.b)("h2",{className:"__internal",id:"用插件扩展"},"用插件扩展",Object(p.b)("a",s({parentName:"h2"},{href:"#%E7%94%A8%E6%8F%92%E4%BB%B6%E6%89%A9%E5%B1%95","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"与加载器相比, 插件是一种扩展 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的更灵活的方法。您可以访问 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的",Object(p.b)("strong",{parentName:"p"},"编译器"),"和",Object(p.b)("strong",{parentName:"p"},"编译过程"),"。可以运行子编译器, 并且插件可以与加载器一起工作, 就像 ",Object(p.b)("inlineCode",{parentName:"p"},"MiniCssExtractPlugin")," 插件那样。"),Object(p.b)("p",null,"插件允许您通过钩子拦截 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的执行。",Object(p.b)("inlineCode",{parentName:"p"},"Webpack")," 本身也是以插件集合形式的实现。它的底层依赖于 ",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/tapable",target:"_blank"}),"tapable")," 插件接口, 允许 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 以不同的方式应用插件。"),Object(p.b)("p",null,"接下来你将学会开发几个小插件。与加载器不同, 没有单独的环境可以运行插件, 因此您必须使用 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 本身运行它们。但是, 可以将较小的逻辑在 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 之外运行, 因为这允许您单独对其进行单元测试。"),Object(p.b)("h3",{className:"__internal",id:"webpack-插件的基本流程"},"webpack 插件的基本流程",Object(p.b)("a",s({parentName:"h3"},{href:"#webpack-%E6%8F%92%E4%BB%B6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"一个 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 插件应该公开一个 ",Object(p.b)("inlineCode",{parentName:"p"},"apply(compiler)")," 方法。",Object(p.b)("inlineCode",{parentName:"p"},"JavaScript")," 提供了多种方法来执行此操作。您可以使用一个函数, 然后将方法附加到其 ",Object(p.b)("inlineCode",{parentName:"p"},"prototype")," 上。要使用最新的语法, 您可以使用 ",Object(p.b)("inlineCode",{parentName:"p"},"class")," 对相同的想法进行建模。"),Object(p.b)("p",null,"无论采用哪种方法, 都应捕获用户在构造函数中传递的可能选项。声明某种模式以将其传达给用户是一个好主意。",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/schema-utils",target:"_blank"}),"schema-utils")," 允许验证并与加载器一起使用。"),Object(p.b)("p",null,"当插件连接到 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 配置时, ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 将运行其构造函数并传递编译器对象给 ",Object(p.b)("inlineCode",{parentName:"p"},"apply")," 进行调用。该对象公开了 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的插件 ",Object(p.b)("inlineCode",{parentName:"p"},"API"),", 并允许您使用",Object(p.b)("a",s({parentName:"p"},{href:"https://webpack.js.org/api/plugins/compiler/",target:"_blank"}),"官方编译器参考"),"中列出的钩子。"),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-defaults",target:"_blank"}),"webpack-defaults")," 可以用作开发 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 插件的起点。它包含用于开发官方 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 加载器和插件的基础结构。")),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"要详细了解插件流程, 请参阅 ",Object(p.b)("a",s({parentName:"p"},{href:"https://codecrumbs.io/stories/webpack-tapable-core",target:"_blank"}),"Under the hood webpack: core library behind the event-driven architecture")," 进行具体分析。")),Object(p.b)("h3",{className:"__internal",id:"建立开发环境"},"建立开发环境",Object(p.b)("a",s({parentName:"h3"},{href:"#%E5%BB%BA%E7%AB%8B%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"由于插件必须在 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 中运行, 因此您必须配置一个环境, 以运行可进一步开发的 ",Object(p.b)("inlineCode",{parentName:"p"},"demo")," 插件:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"webpack.plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"const")," path ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"require"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"path"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"const")," DemoPlugin ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"require"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"./plugins/demo-plugin.js"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  mode",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"development"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  entry",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    lib",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," path",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"join"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"__dirname",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"src"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"shake.js"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  plugins",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"new")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"如果尚未创建 ",Object(p.b)("inlineCode",{parentName:"p"},"lib")," 入口文件, 请创建一个。内容并不重要, 只要是 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 可以解析的 ",Object(p.b)("inlineCode",{parentName:"p"},"JavaScript")," 即可。")),Object(p.b)("p",null,"为了方便运行, 请设置构建快捷方式:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"package.json")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"json"},Object(p.b)("pre",s({parentName:"div"},{className:"language-json"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-json"}),Object(p.b)("span",s({parentName:"code"},{className:"token property"}),'"scripts"'),Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token property"}),'"build:plugin"'),Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"wp --config webpack.plugin.js"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ......\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")))),Object(p.b)("p",null,"执行它会抛出 ",Object(p.b)("inlineCode",{parentName:"p"},"Error: Cannot find module"),", 因为实际的插件仍未实现。"),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"如果您想要一个交互式开发环境, 请考虑针对该构建使用 ",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/nodemon",target:"_blank"}),"nodemon"),"。",Object(p.b)("inlineCode",{parentName:"p"},"Webpack")," 的 ",Object(p.b)("inlineCode",{parentName:"p"},"watch")," 模式在这种情况下将无法工作。")),Object(p.b)("h3",{className:"__internal",id:"实现基础插件"},"实现基础插件",Object(p.b)("a",s({parentName:"h3"},{href:"#%E5%AE%9E%E7%8E%B0%E5%9F%BA%E7%A1%80%E6%8F%92%E4%BB%B6","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"最基础的插件应该做两件事: 捕获选项和提供 ",Object(p.b)("inlineCode",{parentName:"p"},"apply")," 方法:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"plugins/demo-plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"module",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"class")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"apply"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"applying"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"如果您运行插件(",Object(p.b)("inlineCode",{parentName:"p"},"npm run build:plugin"),"), 则应该在控制台上看到 ",Object(p.b)("inlineCode",{parentName:"p"},"applying")," 消息。鉴于大多数插件都接受选项, 因此最好捕获它们并将它们传递给 ",Object(p.b)("inlineCode",{parentName:"p"},"apply"),"。"),Object(p.b)("h3",{className:"__internal",id:"捕获选项"},"捕获选项",Object(p.b)("a",s({parentName:"h3"},{href:"#%E6%8D%95%E8%8E%B7%E9%80%89%E9%A1%B9","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"可以通过 ",Object(p.b)("inlineCode",{parentName:"p"},"constructor")," 捕获选项:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"plugins/demo-plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"module",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"class")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"constructor"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"options"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"apply"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"apply"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"如果立即运行该插件将抛出 ",Object(p.b)("inlineCode",{parentName:"p"},"apply undefined")," 消息。"),Object(p.b)("p",null,"调整配置以传递一个选项:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"webpack.plugin.js")),Object(p.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"module",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"..."),Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(p.b)("span",s({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(p.b)("span",s({parentName:"span"},{className:"token comment"}),"// plugins: [new DemoPlugin()],")),"\n",Object(p.b)("span",s({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  plugins",Object(p.b)("span",s({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),"["),Object(p.b)("span",s({parentName:"span"},{className:"token keyword"}),"new")," ",Object(p.b)("span",s({parentName:"span"},{className:"token class-name"}),"DemoPlugin"),Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),"{")," name",Object(p.b)("span",s({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",s({parentName:"span"},{className:"token string"}),'"demo"')," ",Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),"]"),Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")),"  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"现在, 您应该在运行后看到 ",Object(p.b)("inlineCode",{parentName:"p"},"apply { name: 'demo' }"),"。"),Object(p.b)("h3",{className:"__internal",id:"了解-compiler-和-compilation"},"了解 compiler 和 compilation",Object(p.b)("a",s({parentName:"h3"},{href:"#%E4%BA%86%E8%A7%A3-compiler-%E5%92%8C-compilation","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("inlineCode",{parentName:"p"},"apply")," 接收 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的 ",Object(p.b)("inlineCode",{parentName:"p"},"compiler")," 作为参数。调整如下:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"plugins/demo-plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"module",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"class")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"constructor"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"options"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"apply"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"compiler"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"compiler",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"运行后, 您应该看到很多数据。特别是 ",Object(p.b)("inlineCode",{parentName:"p"},"options")," 应该看起来熟悉, 因为它包含 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 配置。您还可以看到熟悉的名称, 例如 ",Object(p.b)("inlineCode",{parentName:"p"},"records"),"。"),Object(p.b)("p",null,"如果您浏览了 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的",Object(p.b)("a",s({parentName:"p"},{href:"https://webpack.js.org/api/plugins/",target:"_blank"}),"插件开发文档"),", 将会看到编译器提供了大量的钩子。每个挂钩对应一个特定阶段。例如, 要产出文件, 您可以侦听 ",Object(p.b)("inlineCode",{parentName:"p"},"emit")," 事件然后进行修改。"),Object(p.b)("p",null,"将实现更改为侦听和捕获 ",Object(p.b)("inlineCode",{parentName:"p"},"compilation"),":",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"plugins/demo-plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"module",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"class")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"constructor"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"options"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"apply"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"compiler"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    compiler",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"emit",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"tapAsync"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"DemoPlugin"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"compilation",Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," cb"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n        console",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"compilation",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\n        ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"cb"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)(l,s({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"忘记回调并运行插件会使 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 静默失败!")),Object(p.b)("p",null,"运行构建应打印比以前更多的信息, 因为编译对象包含 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 遍历的整个依赖关系图。您可以访问与此相关的所有内容, 包括入口, 块, 模块, 资源等。"),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"许多可用的钩子都公开了编译, 但有时它们会揭示了更具体的结构, 并且需要具体的研究才能理解它们。")),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"加载器可以通过下划线形式(",Object(p.b)("inlineCode",{parentName:"p"},"this._compiler"),"/",Object(p.b)("inlineCode",{parentName:"p"},"this._compilation"),")对 ",Object(p.b)("inlineCode",{parentName:"p"},"compiler")," 和 ",Object(p.b)("inlineCode",{parentName:"p"},"compilation")," 进行脏访问。")),Object(p.b)("h3",{className:"__internal",id:"通过-compilation-写入文件"},"通过 compilation 写入文件",Object(p.b)("a",s({parentName:"h3"},{href:"#%E9%80%9A%E8%BF%87-compilation-%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("inlineCode",{parentName:"p"},"compilation")," 中的 ",Object(p.b)("inlineCode",{parentName:"p"},"assets")," 对象, 可用于编写新的文件。您还可以捕获已创建的资源, 并对其进行修改。"),Object(p.b)("p",null,"要编写资源, 您必须使用 ",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-sources",target:"_blank"}),"webpack-sources"),"。"),Object(p.b)("p",null,"如果您使用的是 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack 4")," 或更低版本, 请先安装:"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(p.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"npm")," ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"add")," webpack-sources --develop"))),Object(p.b)("p",null,"调整代码, 如下所示:",Object(p.b)("br",{parentName:"p"}),"\n",Object(p.b)("strong",{parentName:"p"},"plugins/demo-plugin.js")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),Object(p.b)("span",s({parentName:"code"},{className:"token comment"}),'// In webpack 5, you can use require("webpack").sources'),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"const")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{")," RawSource ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"require"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"webpack-sources"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\nmodule",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"exports ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"class")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"DemoPlugin")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"constructor"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"options"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"apply"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"compiler"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"const")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{")," name ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"this"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"options",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    compiler",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"emit",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"tapAsync"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"DemoPlugin"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token parameter"}),"compilation",Object(p.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," cb"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n        compilation",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"assets",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"name",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"new")," ",Object(p.b)("span",s({parentName:"code"},{className:"token class-name"}),"RawSource"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"demo"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\n        ",Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"cb"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"构建后, 您应该看到输出:"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(p.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-bash"}),"⬡ webpack: Build Finished\n⬡ webpack: Hash: 8ef42654fb646b4342f9\n  Version: webpack ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"5.0"),".0-beta.29\n  Time: ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"134")," ms\n  Built at: ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"2020"),"-10-16 ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"15"),":04:17\n  asset demo ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"4")," bytes ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"emitted",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]"),"\n  asset lib.js ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"3.96")," KiB ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"compared ",Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"for")," emit",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"name: lib",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n  Entrypoint lib ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," lib.js\n  ./src/shake.js ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"106")," bytes ",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"]"),"\n      + ",Object(p.b)("span",s({parentName:"code"},{className:"token number"}),"3")," hidden modules "))),Object(p.b)("p",null,"如果您检查 ",Object(p.b)("inlineCode",{parentName:"p"},"dist/demo")," 文件, 您将看到它包含上面示例代码中的 ",Object(p.b)("inlineCode",{parentName:"p"},"demo")," 一词。"),Object(p.b)(l,s({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},Object(p.b)("inlineCode",{parentName:"p"},"compilation")," 有其自己的一套钩子, 如",Object(p.b)("a",s({parentName:"p"},{href:"https://webpack.js.org/api/plugins/compiler/",target:"_blank"}),"官方编译参考中所述"),"。")),Object(p.b)("h3",{className:"__internal",id:"管理警告和错误"},"管理警告和错误",Object(p.b)("a",s({parentName:"h3"},{href:"#%E7%AE%A1%E7%90%86%E8%AD%A6%E5%91%8A%E5%92%8C%E9%94%99%E8%AF%AF","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"抛出 ",Object(p.b)("inlineCode",{parentName:"p"},'throw new Error("Message")')," 可能导致插件执行失败。如果您验证 ",Object(p.b)("inlineCode",{parentName:"p"},"options"),", 则可以使用此方法。"),Object(p.b)("p",null,"如果要在编译过程中向用户发出警告或错误消息, 则应使用 ",Object(p.b)("inlineCode",{parentName:"p"},"compilation.warnings")," 和 ",Object(p.b)("inlineCode",{parentName:"p"},"compilation.errors"),"。例:  "),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),"compilation",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"warnings",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"push"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"warning"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\ncompilation",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"errors",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"push"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"error"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"有一个日志记录 ",Object(p.b)("inlineCode",{parentName:"p"},"API"),", 可让您将消息传递到 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack"),"。考虑以下 ",Object(p.b)("inlineCode",{parentName:"p"},"API"),":  "),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",s({parentName:"div"},{className:"language-js"}),Object(p.b)("code",s({parentName:"pre"},{className:"language-js"}),Object(p.b)("span",s({parentName:"code"},{className:"token keyword"}),"const")," logger ",Object(p.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," compiler",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"getInfrastructureLogger"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"Demo Plugin"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\nlogger",Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",s({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",s({parentName:"code"},{className:"token string"}),'"hello from compiler"'),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"您可以使用熟悉的 ",Object(p.b)("inlineCode",{parentName:"p"},"console API"),", ",Object(p.b)("inlineCode",{parentName:"p"},"warning"),", ",Object(p.b)("inlineCode",{parentName:"p"},"error"),", ",Object(p.b)("inlineCode",{parentName:"p"},"group")," 等其他方法也可以使用。有关更多详细信息, 请参见",Object(p.b)("a",s({parentName:"p"},{href:"https://webpack.js.org/api/logging/",target:"_blank"}),"日志文档"),"。"),Object(p.b)("h3",{className:"__internal",id:"插件可以有插件"},"插件可以有插件",Object(p.b)("a",s({parentName:"h3"},{href:"#%E6%8F%92%E4%BB%B6%E5%8F%AF%E4%BB%A5%E6%9C%89%E6%8F%92%E4%BB%B6","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"插件可以提供自己的钩子。",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/html-webpack-plugin",target:"_blank"}),"html-webpack-plugin")," 是使用插件扩展自身的很好的例子。"),Object(p.b)("h3",{className:"__internal",id:"插件可以运行自己的-compiler"},"插件可以运行自己的 compiler",Object(p.b)("a",s({parentName:"h3"},{href:"#%E6%8F%92%E4%BB%B6%E5%8F%AF%E4%BB%A5%E8%BF%90%E8%A1%8C%E8%87%AA%E5%B7%B1%E7%9A%84-compiler","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"在特定情况下, 运行子编译器很有意义, 例如 ",Object(p.b)("a",s({parentName:"p"},{href:"https://www.npmjs.com/package/offline-plugin",target:"_blank"}),"offline-plugin"),"。它可以完全控制相关的入口和输出。插件的作者 Arthur Stolyar 在 ",Object(p.b)("a",s({parentName:"p"},{href:"https://stackoverflow.com/questions/38276028/webpack-child-compiler-change-configuration",target:"_blank"}),"Stack Overflow 上解释了子编译器的想法"),"。"),Object(p.b)("h3",{className:"__internal",id:"结论"},"结论",Object(p.b)("a",s({parentName:"h3"},{href:"#%E7%BB%93%E8%AE%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"当您开始设计插件时, 请花时间研究类似的现有插件。分批开发插件, 以便您一次验证一个插件。鉴于 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 本身是插件的集合, 因此研究它的源代码可以提供更深入的理解。"),Object(p.b)("p",null,"回顾一下:"),Object(p.b)("ul",null,Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(p.b)("strong",{parentName:"li"},"插件"),"可以拦截 ",Object(p.b)("inlineCode",{parentName:"li"},"webpack")," 的执行并对其扩展, 从而使其比加载器更加灵活。"),Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),"插件可以与加载器结合使用。",Object(p.b)("inlineCode",{parentName:"li"},"MiniCssExtractPlugin")," 就是这样工作的。随附的加载器用于标记要提取的资产。"),Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),"插件可以访问 ",Object(p.b)("inlineCode",{parentName:"li"},"webpack")," 的 ",Object(p.b)("inlineCode",{parentName:"li"},"compiler")," 和 ",Object(p.b)("inlineCode",{parentName:"li"},"compilation"),"。两者都为 ",Object(p.b)("inlineCode",{parentName:"li"},"webpack")," 执行流程的不同阶段提供了钩, 并允许您对其进行操作。",Object(p.b)("inlineCode",{parentName:"li"},"Webpack")," 本身就是以这种方式实现的。"),Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),"插件可以产出新资源并修改现有资源。"),Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),"插件可以实现自己的插件系统。",Object(p.b)("inlineCode",{parentName:"li"},"HtmlWebpackPlugin")," 是此类插件的示例。"),Object(p.b)("li",s({parentName:"ul"},{className:"__internal"}),"插件可以自己运行 ",Object(p.b)("inlineCode",{parentName:"li"},"compiler"),"。隔离提供了更多控制权, 并允许被 ",Object(p.b)("inlineCode",{parentName:"li"},"offline-plugin")," 这样的插件修改。")))}i.isMDXComponent=!0,i=Object(c.hot)(e)(i),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(r,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/plugins.md"),b.register(l,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/plugins.md"),b.register(N,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/plugins.md"),b.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/plugins.md"),b.register(i,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Extending/plugins.md")),(m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&m(e)}.call(this,n(21)(e))}}]);