(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{165:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return i}));var t,c=n(85),s=(n(127),n(0),n(86));function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,m,r=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",a)}},N=r("MdAlert"),l={};function i(e){var a=e.components,n=o(e,["components"]);return Object(s.b)("wrapper",p({},l,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h2",{className:"__internal",id:"清除未使用的-css"},"清除未使用的 CSS",Object(s.b)("a",p({parentName:"h2"},{href:"#%E6%B8%85%E9%99%A4%E6%9C%AA%E4%BD%BF%E7%94%A8%E7%9A%84-css","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"诸如 ",Object(s.b)("a",p({parentName:"p"},{href:"https://getbootstrap.com/",target:"_blank"}),"Bootstrap")," 或 ",Object(s.b)("a",p({parentName:"p"},{href:"https://tailwindcss.com/",target:"_blank"}),"Tailwind")," 之类的框架往往自带了大量 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式。通常, 您只会使用其中的一小部分, 如果不进行任何处理, 会捆绑这些未使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式。好在这个问题可以通过插件来解决。"),Object(s.b)("p",null,Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/purgecss",target:"_blank"}),"PurgeCSS")," 是可以通过分析文件来实现清理 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式的插件。它遍历您的代码并找出正在使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 类。通常, 有足够的信息让它从项目您的项目中清除未使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS"),"。它在一定程度上也适用于单页应用程序。"),Object(s.b)("p",null,Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/uncss",target:"_blank"}),"uncss")," 是一个不错的替代品。它通过 ",Object(s.b)("inlineCode",{parentName:"p"},"PhantomJS")," 运行, 并以不同的机制执行清除工作。您可以将 ",Object(s.b)("inlineCode",{parentName:"p"},"uncss")," 本身用作 ",Object(s.b)("inlineCode",{parentName:"p"},"PostCSS")," 的插件。",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/dropcss",target:"_blank"}),"dropcss")," 是另一种可选的插件。"),Object(s.b)("p",null,"鉴于 ",Object(s.b)("inlineCode",{parentName:"p"},"PurgeCSS")," 与 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 一起使用效果最佳, 我们将在本章中演示其用法。"),Object(s.b)("h3",{className:"__internal",id:"设置-tailwind"},"设置 Tailwind",Object(s.b)("a",p({parentName:"h3"},{href:"#%E8%AE%BE%E7%BD%AE-tailwind","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"为了使演示更加逼真, 让我们将 ",Object(s.b)("inlineCode",{parentName:"p"},"Tailwind")," 安装到项目中:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," tailwindcss postcss-loader --develop"))),Object(s.b)("p",null,"要加载 ",Object(s.b)("inlineCode",{parentName:"p"},"Tailwind"),", 我们必须使用 ",Object(s.b)("inlineCode",{parentName:"p"},"PostCSS"),":"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.parts.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),"exports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"tailwind")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  loader",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"postcss-loader"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  options",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// postcssOptions: {"),"\n        plugins",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"tailwindcss"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// }"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"译者注: 如果使用 ",Object(s.b)("inlineCode",{parentName:"p"},"PostCSS 4.x"),", 请添加注释内容。")),Object(s.b)("p",null,"新的配置依旧需要进行连接:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.config.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," cssLoaders ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"parts",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"tailwind"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// const productionConfig = merge([parts.extractCSS()]);")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"const")," productionConfig ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"[")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," loaders",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," cssLoaders ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," developmentConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  parts",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"devServer"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// parts.extractCSS({ options: { hmr: true } }),")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," options",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," hmr",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token boolean"}),"true")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," loaders",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," cssLoaders ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"要在项目中使用 ",Object(s.b)("inlineCode",{parentName:"p"},"Tailwind"),", 需要在 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 中使用 ",Object(s.b)("inlineCode",{parentName:"p"},"import")," 引入:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"src/main.css")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"css"},Object(s.b)("pre",p({parentName:"div"},{className:"language-css"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-css"}),Object(s.b)("span",p({parentName:"code"},{className:"token atrule"}),Object(s.b)("span",p({parentName:"span"},{className:"token rule"}),"@tailwind")," base",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token atrule"}),Object(s.b)("span",p({parentName:"span"},{className:"token rule"}),"@tailwind")," components",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"/* Write your utility classes here */"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token atrule"}),Object(s.b)("span",p({parentName:"span"},{className:"token rule"}),"@tailwind")," utilities",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token selector"}),"body")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token property"}),"background"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),":")," cornsilk",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("h3",{className:"__internal",id:"使用-tailwind-类"},"使用 Tailwind 类",Object(s.b)("a",p({parentName:"h3"},{href:"#%E4%BD%BF%E7%94%A8-tailwind-%E7%B1%BB","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"您还应该让演示组件使用 ",Object(s.b)("inlineCode",{parentName:"p"},"Tailwind")," 类, 因此可以使用以下方法:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"src/component.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"export")," ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"default")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"text ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"Hello world"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," element ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," document",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"createElement"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"div"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  element",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"className ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"rounded bg-red-100 border max-w-md m-4 p-4"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n  element",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"innerHTML ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," text",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," element",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"如果运行应用程序(",Object(s.b)("inlineCode",{parentName:"p"},"npm start"),"), 则 ",Object(s.b)("inlineCode",{parentName:"p"},'"Hello world"')," 应该看起来像一个按钮。\n",Object(s.b)("img",p({parentName:"p"},{src:"../../style/hello_style.webp",alt:"hello world!"}))),Object(s.b)("p",null,"构建应用程序(",Object(s.b)("inlineCode",{parentName:"p"},"npm run build"),")应该会在控制台输出:"),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),"⬡ webpack: Build Finished\n⬡ webpack: Hash: 2b83e88cf64c16dd9adc\n  Version: webpack ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"5.0"),".0-beta.29\n  Time: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"3264")," ms\n  Built at: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"2020"),"-09-10 ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"14"),":34:57\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  asset ./css/main.css ",Object(s.b)("span",p({parentName:"span"},{className:"token number"}),"1.96")," MiB ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"["),"big",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")")),"  asset index.html ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"243")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  asset main.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"14.7")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"minimized",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),".."),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),".."),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"..")))),Object(s.b)("p",null,"如您所见, ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式文件的大小增加了, 这是需要使用 ",Object(s.b)("inlineCode",{parentName:"p"},"PurgeCSS")," 解决的问题。"),Object(s.b)("h3",{className:"__internal",id:"清除-css"},"清除 CSS",Object(s.b)("a",p({parentName:"h3"},{href:"#%E6%B8%85%E9%99%A4-css","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/purgecss-webpack-plugin",target:"_blank"}),"purgecss-webpack-plugin")," 允许您清除未使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式, 因为理想情况下, 我们仅应当打包我们正在使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 类。"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," glob purgecss-webpack-plugin --develop"))),Object(s.b)("p",null,"您还需要进行如下配置:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.parts.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," path ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"path"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," glob ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"glob"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," PurgeCSSPlugin ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"purgecss-webpack-plugin"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," ",Object(s.b)("span",p({parentName:"code"},{className:"token constant"}),"ALL_FILES")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," glob",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"sync"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"path",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"join"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"__dirname",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"src/*.js"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nexports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"eliminateUnusedCSS")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  plugins",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"new")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"PurgeCSSPlugin"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      whitelistPatterns",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Example: /^svg-/"),"\n      paths",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token constant"}),"ALL_FILES"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",p({parentName:"code"},{className:"token comment"}),"// Consider extracting as a parameter"),"\n      extractors",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n          ",Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"extractor"),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),"content"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>"),"\n            content",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"match"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token regex"}),"/[^<>\"'`\\s]*[^<>\"'`\\s:]/g"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"||")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n          extensions",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"html"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"接下来将 ",Object(s.b)("inlineCode",{parentName:"p"},"PurgeCSS")," 连接到配置中。该插件必须在 ",Object(s.b)("inlineCode",{parentName:"p"},"MiniCssExtractPlugin")," 之后使用, 否则无效。"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.config.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," productionConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  parts",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," loaders",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," cssLoaders ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"eliminateUnusedCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 相关调用的顺序并不重要, 因为插件将注册到构建的不同部分。"),Object(s.b)("p",null,"如果立即执行 ",Object(s.b)("mark",null,"npm run build"),", 应该会看到以下内容:"),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),"⬡ webpack: Build Finished\n⬡ webpack: Hash: 2b83e88cf64c16dd9adc\n  Version: webpack ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"5.0"),".0-beta.29\n  Time: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"3872")," ms\n  Built at: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"2020"),"-09-10 ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"14"),":47:36\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  asset ./css/main.css ",Object(s.b)("span",p({parentName:"span"},{className:"token number"}),"7.77")," KiB ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")")),"  asset index.html ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"243")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  asset main.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"14.7")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"emitted",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"minimized",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),".."),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),".."),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"..")))),Object(s.b)("p",null,"样式文件的大小已明显减小, 原本为 ",Object(s.b)("inlineCode",{parentName:"p"},"1.96MB")," 现在大约只有 ",Object(s.b)("inlineCode",{parentName:"p"},"7KB"),"。这对于更加庞大的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 框架而言, 效果更加显著。"),Object(s.b)(N,p({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},Object(s.b)("inlineCode",{parentName:"p"},"Tailwind")," 包含了开箱即用地 ",Object(s.b)("inlineCode",{parentName:"p"},"PurgeCSS"),", 最好使用它。有关更多信息, 请参见 ",Object(s.b)("a",p({parentName:"p"},{href:"https://tailwindcss.com/docs/controlling-file-size/#removing-unused-css",target:"_blank"}),"Tailwind 文档"),"。上面的示例足以实现该想法, 并且可以通用。")),Object(s.b)("h3",{className:"__internal",id:"关键路径渲染"},"关键路径渲染",Object(s.b)("a",p({parentName:"h3"},{href:"#%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84%E6%B8%B2%E6%9F%93","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,Object(s.b)("a",p({parentName:"p"},{href:"https://developers.google.com/web/fundamentals/performance/critical-rendering-path/",target:"_blank"}),"关键路径渲染"),"的想法从另一个角度看待 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 性能。它没有优化大小, 而是优化了渲染顺序并强调了首屏 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 样式。通过呈现页面, 然后弄清楚需要哪些样式才能获得想要显示的结果, 从而获得结果。"),Object(s.b)("p",null,"Addy Osmani 撰写的 ",Object(s.b)("a",p({parentName:"p"},{href:"https://github.com/addyosmani/critical-path-css-tools",target:"_blank"}),"critical-path-css-tools")," 列出了与该方法相关的工具。"),Object(s.b)("h3",{className:"__internal",id:"结论"},"结论",Object(s.b)("a",p({parentName:"h3"},{href:"#%E7%BB%93%E8%AE%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"使用 ",Object(s.b)("inlineCode",{parentName:"p"},"PurgeCSS")," 可以大大减少样式文件的大小。对于依赖大型 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 框架的静态网站而言, 它尤其有价值。网站或应用程序变得越动态, 就越难以可靠地进行分析。"),Object(s.b)("p",null,"回顾一下:"),Object(s.b)("ul",null,Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"使用 ",Object(s.b)("inlineCode",{parentName:"li"},"PurgeCSS")," 可以清除未使用的 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS"),"。它对源文件执行静态分析。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"可以通过 ",Object(s.b)("strong",{parentName:"li"},Object(s.b)("inlineCode",{parentName:"strong"},"purgecss-webpack-plugin"))," 启用该功能。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"实际上, ",Object(s.b)("inlineCode",{parentName:"li"},"PurgeCSS")," 可以清除大多数(如果不是全部)未使用的 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS")," 样式。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"关键路径渲染是另一种 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS")," 技术, 该技术强调首先渲染屏幕上的 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS")," 样式。想法是尽可能快地渲染一些东西, 而不是等待所有 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS")," 加载完毕。")),Object(s.b)("p",null,"在下一章中, 您将学习自动处理前缀。启用该功能使生产版本适用于旧版浏览器的复杂 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 更加方便。"))}i.isMDXComponent=!0,i=Object(c.hot)(e)(i),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(r,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/eliminating-unused-css.md"),b.register(N,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/eliminating-unused-css.md"),b.register(l,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/eliminating-unused-css.md"),b.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/eliminating-unused-css.md"),b.register(i,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/eliminating-unused-css.md")),(m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&m(e)}.call(this,n(21)(e))}}]);