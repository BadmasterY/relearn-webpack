(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{147:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return i}));var t,c=n(86),s=(n(127),n(0),n(87));function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,r,m=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",a)}},l=m("MdAlert"),N={};function i(e){var a=e.components,n=o(e,["components"]);return Object(s.b)("wrapper",p({},N,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h2",{className:"__internal",id:"分离-css"},"分离 CSS",Object(s.b)("a",p({parentName:"h2"},{href:"#%E5%88%86%E7%A6%BB-css","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"即使现在建立了一个不错的构建, 所有 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 都去了哪里? 根据配置, 它已内联到 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 中! 尽管这在开发过程中很方便, 但听起来并不理想。"),Object(s.b)("p",null,"当前的解决方案不允许缓存 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS"),"。这将导致",Object(s.b)("strong",{parentName:"p"},"文档样式闪烁"),"(",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"Flash of Unstyled Content")),", ",Object(s.b)("inlineCode",{parentName:"p"},"FOUC"),")。发生 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"FOUC"))," 的原因是浏览器需要花费一些时间来加载 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript"),", 然后才能应用样式。将 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 拆分为单独的文件可以避免这种问题, 它允许浏览器对其进行单独管理。"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 使用 ",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/mini-css-extract-plugin",target:"_blank"}),"mini-css-extract-plugin")," (",Object(s.b)("inlineCode",{parentName:"p"},"MCEP"),")提供了一种生成单独的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 捆绑包的方法。它可以将多个 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件组合为一个。因此, 它附带了一个处理提取过程的加载器。然后, 插件获取由加载器组合的结果, 并产出带有样式的单独文件。"),Object(s.b)(l,p({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"在生产环境中使用 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 加载内联样式可能具有潜在的危险, 因为它可以作为一个潜在的攻击媒介。",Object(s.b)("strong",{parentName:"p"},"关键路径渲染"),"包含在初始 ",Object(s.b)("inlineCode",{parentName:"p"},"HTML")," 有效负载中以内联样式渲染关键 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 的想法, 从而改善网站的感知性能。在有限的上下文中, 内联少量 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 可能是可行的选择, 以减少请求数量, 从而加快初始负载。")),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},Object(s.b)("a",p({parentName:"p"},{href:"https://github.com/faceyspacey/extract-css-chunks-webpack-plugin",target:"_blank"}),"extract-css-chunks-webpack-plugin")," 是由社区维护的替代 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"mini-css-extract-plugin"))," 的插件, 该插件特别为服务器端渲染而设计。")),Object(s.b)("h3",{className:"__internal",id:"minicssextractplugin-配置"},"MiniCssExtractPlugin 配置",Object(s.b)("a",p({parentName:"h3"},{href:"#minicssextractplugin-%E9%85%8D%E7%BD%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"首先安装插件:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," mini-css-extract-plugin --develop"))),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"译者注: 该插件依赖的 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"normalize-url"))," 需要依赖 ",Object(s.b)("inlineCode",{parentName:"p"},"url")," 包, ",Object(s.b)("inlineCode",{parentName:"p"},"webpack < 5")," 默认添加该依赖, 而 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack 5")," 以后需要手动添加 ",Object(s.b)("mark",null,"npm add url --develop"),"。")),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"MiniCssExtractPlugin")," 包括一个加载器, ",Object(s.b)("mark",null,"MiniCssExtractPlugin.loader")," 用于标记要提取的资源。然后, 一个插件根据此注释执行其工作。"),Object(s.b)("p",null,"添加配置如下:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.parts.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," MiniCssExtractPlugin ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"mini-css-extract-plugin"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nexports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"extractCSS")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," options ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," loaders ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    module",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      rules",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n          test",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token regex"}),"/\\.css$/"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n          use",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n            ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," loader",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," MiniCssExtractPlugin",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"loader",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," options ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n            ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"css-loader"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n          ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"concat"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"loaders",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    plugins",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"new")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"MiniCssExtractPlugin"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n        filename",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"[name].css"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"该 ",Object(s.b)("mark",null,"[name]")," 占位符使用引用 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 的入口的名称。在",Object(s.b)("a",p({parentName:"p"},{href:""}),"将哈希添加到文件名"),"一章中详细讨论了占位符和哈希。"),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果要将结果文件输出到特定目录, 可以通过传递路径来完成。范例: ",Object(s.b)("mark",null,'filename: "styles/',"[name]",'.css"'),"。")),Object(s.b)("h3",{className:"__internal",id:"连接配置"},"连接配置",Object(s.b)("a",p({parentName:"h3"},{href:"#%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"使用以下配置连接功能:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.config.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," commonConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// parts.loadCSS(),")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// const productionConfig = merge([]);")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"const")," productionConfig ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"[")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," developmentConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," options",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," hmr",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token boolean"}),"true")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"使用此配置, 您仍可以在开发过程中享受来自 ",Object(s.b)("inlineCode",{parentName:"p"},"HMR")," 的便利性。对于生产版本, 可以生成单独的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件。",Object(s.b)("mark",null,"HtmlWebpackPlugin")," 自动将其拾取并将其注入 ",Object(s.b)("inlineCode",{parentName:"p"},"index.html"),"。"),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果您使用 ",Object(s.b)("a",p({parentName:"p"},{href:"../Appendices/css-modules"}),"CSS 模块"),", 请记住按照",Object(s.b)("a",p({parentName:"p"},{href:"./loading-styles"}),'"加载样式"'),"一章中的说明对 ",Object(s.b)("mark",null,"use")," 进行调整。您可以为标准 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 和 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 模块维护单独的配置, 以便通过离散逻辑加载它们。")),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"您现在可以删除该 ",Object(s.b)("mark",null,"loadCSS")," 功能, 因为不再需要它。上面的配置已完全替代了它。")),Object(s.b)("p",null,"运行之后 ",Object(s.b)("mark",null,"npm run build"),", 您应该看到类似于以下内容的输出: "),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),"⬡ webpack: Build Finished\n⬡ webpack: Hash: 8b077f81e014241a6010\n  Version: webpack ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"5.0"),".0-beta.29\n  Time: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"1024")," ms\n  Built at: ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"2020"),"-09-10 ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"13"),":08:23\n  asset ./css/main.css ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"35")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"compared ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"for")," emit",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n  asset index.html ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"243")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"compared ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"for")," emit",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  asset main.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"14.7")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"compared ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"for")," emit",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"minimized",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"name: main",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),"\n  Entrypoint main ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ./css/main.css main.js\n  ./src/index.js + ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"1")," modules ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"271")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/client.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"1.05")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./src/main.css ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"39")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/client.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"3.32")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/log.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"756")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  css ./node_modules/css-loader/dist/cjs.js",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"!"),"./src/main.css ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"34")," bytes ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/ClientSocket.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"2.27")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/hmr.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"1.69")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/overlays/progress-minimal.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"2.38")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/overlays/progress.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"3.88")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/overlays/status.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"8.27")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ./node_modules/webpack-plugin-serve/lib/client/overlays/util.js ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"1.17")," KiB ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"built",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),"\n      + ",Object(s.b)("span",p({parentName:"code"},{className:"token number"}),"4")," hidden modules "))),Object(s.b)("p",null,"现在, 样式已作为单独的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件产出。因此, ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 包体积变得稍小一些, 可以避免 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"FOUC"))," 问题。浏览器不必等待 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 加载即可获取样式信息。它可以单独处理 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS"),", 从而避免出现闪烁。"),Object(s.b)("h3",{className:"__internal",id:"管理-javascript-之外的样式"},"管理 JavaScript 之外的样式",Object(s.b)("a",p({parentName:"h3"},{href:"#%E7%AE%A1%E7%90%86-javascript-%E4%B9%8B%E5%A4%96%E7%9A%84%E6%A0%B7%E5%BC%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"尽管建议通过 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 设置样式然后绑定, 但也可以通过一个 ",Object(s.b)("mark",null,"entry")," 和 ",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/glob",target:"_blank"}),"glob")," 设置 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件来获得相同的结果:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," glob ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"glob"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," commonConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    entry",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n      style",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," glob",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"sync"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"./src/**/*.css"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"进行此类更改之后, 您将不必从应用程序代码中引用样式。在这种方法中, 必须小心 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 的顺序。"),Object(s.b)("p",null,"因此, 您应会同时获得 ",Object(s.b)("inlineCode",{parentName:"p"},"style.css")," 和 ",Object(s.b)("inlineCode",{parentName:"p"},"style.js")," 两个文件。后一个文件包含类似 ",Object(s.b)("mark",null,"webpackJsonp(","[1,3]",",","[function(n,c){}]",");")," 的内容, 同时它不会执行 ",Object(s.b)("a",p({parentName:"p"},{href:"https://github.com/webpack/webpack/issues/1967",target:"_blank"}),"webpack issue 1967")," 中讨论的任何操作。该限制将在 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack 5")," 中消失, 因为它不会为任何空的内容生成 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 文件。"),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"译者注: ",Object(s.b)("inlineCode",{parentName:"p"},"webpack 5")," 中, 确实不再产生任何空的 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 文件了。")),Object(s.b)("p",null,"如果您希望严格控制顺序, 可以设置一个 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 入口, 然后使用 ",Object(s.b)("mark",null,"@import")," 通过该入口将其余部分带到项目中。另一个选择是设置一个 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 入口并通过 ",Object(s.b)("mark",null,"import")," 来获得相同的效果。"),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-watched-glob-entries-plugin",target:"_blank"}),"webpack-watched-glob-entries-plugin")," 提供了一个实现它的工具。另外, 它支持 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 的 ",Object(s.b)("inlineCode",{parentName:"p"},"watch")," 模式, 因此当您修改入口时, ",Object(s.b)("inlineCode",{parentName:"p"},"webpack")," 也会进行更新。")),Object(s.b)("h3",{className:"__internal",id:"结论"},"结论",Object(s.b)("a",p({parentName:"h3"},{href:"#%E7%BB%93%E8%AE%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"当前的配置将样式与 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 巧妙地拆分开。尽管该技术对 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 最有价值, 但它可以用于将任何类型的模块提取到单独的文件中。",Object(s.b)("mark",null,"MiniCssExtractPlugin")," 的难点在于它的配置, 但是复杂性可以隐藏在抽象背后。"),Object(s.b)("p",null,"回顾一下:"),Object(s.b)("ul",null,Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"使用 ",Object(s.b)("mark",null,"MiniCssExtractPlugin")," 解决了",Object(s.b)("strong",{parentName:"li"},"文档样式闪烁"),"(",Object(s.b)("inlineCode",{parentName:"li"},"FOUC"),")的问题。同时, 将 ",Object(s.b)("inlineCode",{parentName:"li"},"CSS")," 与 ",Object(s.b)("inlineCode",{parentName:"li"},"JavaScript")," 拆分开可以改善缓存行为, 并消除了潜在的攻击媒介。"),Object(s.b)("li",p({parentName:"ul"},{className:"__internal"}),"如果您不希望通过 ",Object(s.b)("inlineCode",{parentName:"li"},"JavaScript")," 来维护对样式的引用, 则可以选择通过入口处理它们。但是在这种情况下, 您必须谨慎对待样式顺序。")),Object(s.b)("p",null,"在下一章中, 您将学习如何从项目中清除未使用的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS"),"。"))}i.isMDXComponent=!0,i=Object(c.hot)(e)(i),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(m,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(l,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(N,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(i,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md")),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&r(e)}.call(this,n(21)(e))}}]);