(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{144:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return i}));var t,c=n(86),s=(n(127),n(0),n(87));function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,r,m=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",a)}},l=m("MdAlert"),N={};function i(e){var a=e.components,n=o(e,["components"]);return Object(s.b)("wrapper",p({},N,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h2",{className:"__internal",id:"分离-css"},"分离 CSS",Object(s.b)("a",p({parentName:"h2"},{href:"#%E5%88%86%E7%A6%BB-css","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"即使现在建立了一个不错的构建, 所有 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 都去了哪里? 根据配置, 它已内联到 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 中! 尽管这在开发过程中很方便, 但听起来并不理想。"),Object(s.b)("p",null,"当前的解决方案不允许缓存 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS"),"。这将导致",Object(s.b)("strong",{parentName:"p"},"文档样式闪烁"),"(",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"Flash of Unstyled Content")),", ",Object(s.b)("inlineCode",{parentName:"p"},"FOUC"),")。发生 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"FOUC"))," 的原因是浏览器需要花费一些时间来加载 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript"),", 然后才能应用样式。将 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 拆分为单独的文件可以避免这种问题, 它允许浏览器对其进行单独管理。"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"Webpack")," 使用 ",Object(s.b)("a",p({parentName:"p"},{href:"https://www.npmjs.com/package/mini-css-extract-plugin",target:"_blank"}),"mini-css-extract-plugin")," (",Object(s.b)("inlineCode",{parentName:"p"},"MCEP"),")提供了一种生成单独的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 捆绑包的方法。它可以将多个 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件组合为一个。因此, 它附带了一个处理提取过程的加载器。然后, 插件获取由加载器组合的结果, 并产出带有样式的单独文件。"),Object(s.b)(l,p({message:" ",type:"warning"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"在生产环境中使用 ",Object(s.b)("inlineCode",{parentName:"p"},"JavaScript")," 加载内联样式可能具有潜在的危险, 因为它可以作为一个潜在的攻击媒介。",Object(s.b)("strong",{parentName:"p"},"关键路径渲染"),"包含在初始 ",Object(s.b)("inlineCode",{parentName:"p"},"HTML")," 有效负载中以内联样式渲染关键 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 的想法, 从而改善网站的感知性能。在有限的上下文中, 内联少量 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 可能是可行的选择, 以减少请求数量, 从而加快初始负载。")),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},Object(s.b)("a",p({parentName:"p"},{href:"https://github.com/faceyspacey/extract-css-chunks-webpack-plugin",target:"_blank"}),"extract-css-chunks-webpack-plugin")," 是由社区维护的替代 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"mini-css-extract-plugin"))," 的插件, 该插件特别为服务器端渲染而设计。")),Object(s.b)("h3",{className:"__internal",id:"minicssextractplugin-配置"},"MiniCssExtractPlugin 配置",Object(s.b)("a",p({parentName:"h3"},{href:"#minicssextractplugin-%E9%85%8D%E7%BD%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"首先安装插件:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(s.b)("pre",p({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"npm")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"add")," mini-css-extract-plugin --develop"))),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"译者注: 该插件依赖的 ",Object(s.b)("strong",{parentName:"p"},Object(s.b)("inlineCode",{parentName:"strong"},"normalize-url"))," 需要依赖 ",Object(s.b)("inlineCode",{parentName:"p"},"url")," 包, ",Object(s.b)("inlineCode",{parentName:"p"},"webpack < 5")," 默认添加该依赖, 而 ",Object(s.b)("inlineCode",{parentName:"p"},"webpack 5")," 以后需要手动添加 ",Object(s.b)("mark",null,"npm add url --develop"),"。")),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"MiniCssExtractPlugin")," 包括一个加载器, ",Object(s.b)("mark",null,"MiniCssExtractPlugin.loader")," 用于标记要提取的资源。然后, 一个插件根据此注释执行其工作。"),Object(s.b)("p",null,"添加配置如下:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.parts.js")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," MiniCssExtractPlugin ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"require"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"mini-css-extract-plugin"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\nexports",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function-variable function"}),"extractCSS")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token parameter"}),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," options ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")," loaders ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"["),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=>")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"return")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n    module",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n      rules",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n          test",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token regex"}),"/\\.css$/"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n          use",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n            ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{")," loader",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," MiniCssExtractPlugin",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),"loader",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),",")," options ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n            ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"css-loader"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n          ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"concat"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),"loaders",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n        ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    plugins",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"new")," ",Object(s.b)("span",p({parentName:"code"},{className:"token class-name"}),"MiniCssExtractPlugin"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"{"),"\n        filename",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"code"},{className:"token string"}),'"[name].css"'),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n      ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"该 ",Object(s.b)("mark",null,"[name]")," 占位符使用引用 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 的入口的名称。在",Object(s.b)("a",p({parentName:"p"},{href:""}),"将哈希添加到文件名"),"一章中详细讨论了占位符和哈希。"),Object(s.b)(l,p({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(s.b)("p",{parentName:"MdAlert"},"如果要将结果文件输出到特定目录, 可以通过传递路径来完成。范例: ",Object(s.b)("mark",null,'filename: "styles/',"[name]",'.css"'),"。")),Object(s.b)("h3",{className:"__internal",id:"连接配置"},"连接配置",Object(s.b)("a",p({parentName:"h3"},{href:"#%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(s.b)("p",null,"使用以下配置连接功能:"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"webpack.config.js")),Object(s.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(s.b)("pre",p({parentName:"div"},{className:"language-js"}),Object(s.b)("code",p({parentName:"pre"},{className:"language-js"}),Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," commonConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// parts.loadCSS(),")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token comment"}),"// const productionConfig = merge([]);")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token keyword"}),"const")," productionConfig ",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"[")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),";")),"\n",Object(s.b)("span",p({parentName:"code"},{className:"token keyword"}),"const")," developmentConfig ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",p({parentName:"code"},{className:"token function"}),"merge"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",p({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(s.b)("span",p({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  parts",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"."),Object(s.b)("span",p({parentName:"span"},{className:"token function"}),"extractCSS"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"("),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," options",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"{")," hmr",Object(s.b)("span",p({parentName:"span"},{className:"token operator"}),":")," ",Object(s.b)("span",p({parentName:"span"},{className:"token boolean"}),"true")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),"}"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"span"},{className:"token punctuation"}),",")),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",p({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"使用此设置, 您仍可以在开发过程中享受来自 ",Object(s.b)("inlineCode",{parentName:"p"},"HMR")," 的便利性。对于生产版本, 可以生成单独的 ",Object(s.b)("inlineCode",{parentName:"p"},"CSS")," 文件。",Object(s.b)("mark",null,"HtmlWebpackPlugin")," 自动将其拾取并将其注入 ",Object(s.b)("inlineCode",{parentName:"p"},"index.html"),"。"))}i.isMDXComponent=!0,i=Object(c.hot)(e)(i),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(m,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(l,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(N,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md"),b.register(i,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Styling/separating-css.md")),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&r(e)}.call(this,n(21)(e))}}]);