(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{153:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return N}));var t,c=n(85),p=(n(127),n(0),n(86));function b(){return(b=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function s(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},p=Object.keys(e);for(t=0;t<p.length;t++)n=p[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(t=0;t<p.length;t++)n=p[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var r,o,l=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(p.b)("div",a)}},m=l("MdAlert"),i={};function N(e){var a=e.components,n=s(e,["components"]);return Object(p.b)("wrapper",b({},i,n,{components:a,mdxType:"MDXLayout"}),Object(p.b)("h2",{className:"__internal",id:"构建分析"},"构建分析",Object(p.b)("a",b({parentName:"h2"},{href:"#%E6%9E%84%E5%BB%BA%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"分析构建统计信息是迈向更好地了解 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的好方法。可用的工具有助于回答以下问题:"),Object(p.b)("ul",null,Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"项目包的组成是什么？"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"项目模块具有什么样的依赖关系？"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"项目规模如何随着时间变化？"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"可以安全删除哪些项目模块？"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"哪些项目模块重复？"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"为什么将特定的模块包含在项目包中？")),Object(p.b)("h3",{className:"__internal",id:"配置-webpack"},"配置 webpack",Object(p.b)("a",b({parentName:"h3"},{href:"#%E9%85%8D%E7%BD%AE-webpack","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"为了使 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 产出分析信息, 您应该配置 ",Object(p.b)("inlineCode",{parentName:"p"},"--json")," 标志并将输出通过管道(",Object(p.b)("inlineCode",{parentName:"p"},"pipeline"),")传递到文件, 如下所示:"),Object(p.b)("p",null,Object(p.b)("strong",{parentName:"p"},"package.json")),Object(p.b)("div",{className:"rcpress-highlight","data-language":"json"},Object(p.b)("pre",b({parentName:"div"},{className:"language-json"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-json"}),Object(p.b)("span",b({parentName:"code"},{className:"token property"}),'"scripts"'),Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",b({parentName:"code"},{className:"token property"}),'"build:stats"'),Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"code"},{className:"token string"}),'"wp --mode production --json > stats.json"'),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),","),"\n  ......\n",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),",")))),Object(p.b)("p",null,"无论您的 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 配置如何, 以上是您所需的基本设置。立即执行 ",Object(p.b)("inlineCode",{parentName:"p"},"npm run build:stats"),"。一段时间后, 您应该在项目根目录中找到 ",Object(p.b)("em",{parentName:"p"},Object(p.b)("inlineCode",{parentName:"em"},"stats.json")),"。可以通过各种工具推送此文件, 以更好地了解正在发生的事情。"),Object(p.b)("p",null,"您还可以考虑使用以下标志:"),Object(p.b)("ul",null,Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("inlineCode",{parentName:"li"},"--profile")," 捕获与时序有关的信息。该设置是可选的, 但易于设置。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("inlineCode",{parentName:"li"},"--progress")," 以显示 ",Object(p.b)("inlineCode",{parentName:"li"},"webpack")," 在构建的不同阶段花费了多长时间。")),Object(p.b)("h4",{className:"__internal",id:"node-api"},"Node API",Object(p.b)("a",b({parentName:"h4"},{href:"#node-api","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"可以通过 ",Object(p.b)("inlineCode",{parentName:"p"},"Node")," 捕获统计信息。由于统计信息可能包含错误, 因此最好单独处理这种情况:"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(p.b)("pre",b({parentName:"div"},{className:"language-js"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-js"}),Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"const")," webpack ",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"require"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token string"}),'"webpack"'),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"const")," config ",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"require"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token string"}),'"./webpack.config.js"'),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token string"}),'"production"'),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"webpack"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"config",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),",")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token parameter"}),"err",Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")," stats"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"=>")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"if")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"return")," console",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"error"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"err",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"if")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"stats",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"hasErrors"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")")," ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"return")," console",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"error"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"stats",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"toString"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token string"}),'"errors-only"'),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  console",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"."),Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"log"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"stats",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"}"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"如果您想对统计数据进行进一步的处理, 这种技术可能很有价值, 尽管通常其他解决方案就足够了。"),Object(p.b)(m,b({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"如果要从 ",Object(p.b)("inlineCode",{parentName:"p"},"stats")," 输出 ",Object(p.b)("inlineCode",{parentName:"p"},"JSON"),", 请使用 ",Object(p.b)("inlineCode",{parentName:"p"},"stats.toJson()"),"。要获取详细的输出, 请使用 ",Object(p.b)("inlineCode",{parentName:"p"},'stats.toJson("verbose")'),"。它遵循 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 支持的所有统计信息选项。")),Object(p.b)(m,b({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},"要模拟该 ",Object(p.b)("inlineCode",{parentName:"p"},"--json")," 标志, 请使用 ",Object(p.b)("inlineCode",{parentName:"p"},"console.log(JSON.stringify(stats.toJson(), null, 2));"),"。输出被格式化为可读的形式。")),Object(p.b)("h4",{className:"__internal",id:"webpack-stats-plugin-和-webpack-bundle-tracker"},"webpack-stats-plugin 和 webpack-bundle-tracker",Object(p.b)("a",b({parentName:"h4"},{href:"#webpack-stats-plugin-%E5%92%8C-webpack-bundle-tracker","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"如果要通过插件管理统计信息, 请查看 ",Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-stats-plugin",target:"_blank"}),"webpack-stats-plugin"),"。它使您可以控制输出, 并可以在写入之前对其进行转换。您可以使用它从输出中排除特定的依赖项。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-bundle-tracker",target:"_blank"}),"webpack-bundle-tracker")," 可以在 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 编译时捕获数据。为此, 它使用 ",Object(p.b)("inlineCode",{parentName:"p"},"JSON"),"。"),Object(p.b)("h3",{className:"__internal",id:"启用性能预算"},"启用性能预算",Object(p.b)("a",b({parentName:"h3"},{href:"#%E5%90%AF%E7%94%A8%E6%80%A7%E8%83%BD%E9%A2%84%E7%AE%97","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("inlineCode",{parentName:"p"},"Webpack")," 允许您定义性能预算。这个想法是它给您的构建进行大小限制, 它必须遵循该限制。该功能默认情况下处于禁用状态, 并且计算包括要计算的入口块。"),Object(p.b)("p",null,"要将功能集成到项目中, 请如下调整配置:"),Object(p.b)("p",null,Object(p.b)("strong",{parentName:"p"},"webpack.config.js")),Object(p.b)("div",{className:"rcpress-highlight has-highlighted-lines","data-language":"js"},Object(p.b)("pre",b({parentName:"div"},{className:"language-js"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-js"}),Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"const")," productionConfig ",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"=")," ",Object(p.b)("span",b({parentName:"code"},{className:"token function"}),"merge"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"["),"\n",Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),"{")),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    performance",Object(p.b)("span",b({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),"{")),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      hints",Object(p.b)("span",b({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"span"},{className:"token string"}),'"warning"'),Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")," ",Object(p.b)("span",b({parentName:"span"},{className:"token comment"}),'// "error" or false are valid too')),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      maxEntrypointSize",Object(p.b)("span",b({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"span"},{className:"token number"}),"50000"),Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")," ",Object(p.b)("span",b({parentName:"span"},{className:"token comment"}),"// in bytes, default 250k")),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"      maxAssetSize",Object(p.b)("span",b({parentName:"span"},{className:"token operator"}),":")," ",Object(p.b)("span",b({parentName:"span"},{className:"token number"}),"100000"),Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")," ",Object(p.b)("span",b({parentName:"span"},{className:"token comment"}),"// in bytes")),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"    ",Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),"}"),Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")),Object(p.b)("span",b({parentName:"code"},{className:"rcpress-highlight-code-line"}),"  ",Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),"}"),Object(p.b)("span",b({parentName:"span"},{className:"token punctuation"}),",")),"  ",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"..."),Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"..."),"\n",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"]"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),";")))),Object(p.b)("p",null,"如果您的项目超出限制, 您应该看到类似以下的警告:"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(p.b)("pre",b({parentName:"div"},{className:"language-bash"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-bash"}),"WARNING ",Object(p.b)("span",b({parentName:"code"},{className:"token keyword"}),"in")," entrypoint size limit: The following entrypoint",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"s",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")")," combined asset size exceeds the recommended limit ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"48.8")," KiB",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),". This can impact web performance.\n  Entrypoints:\n    main ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"143")," KiB",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\n        runtime.6ed3.js\n        ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"728"),".7dfb.js\n        main.be03.css\n        main.2629.js"))),Object(p.b)("p",null,"如果要在 ",Object(p.b)("inlineCode",{parentName:"p"},"CI")," 环境中实施严格限制, 请设置 ",Object(p.b)("inlineCode",{parentName:"p"},"hints")," 为 ",Object(p.b)("inlineCode",{parentName:"p"},"error"),"。这样做会导致构建失败, 并迫使开发人员修改限制或就良好限制进行讨论。"),Object(p.b)("h3",{className:"__internal",id:"依赖性分析"},"依赖性分析",Object(p.b)("a",b({parentName:"h3"},{href:"#%E4%BE%9D%E8%B5%96%E6%80%A7%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"可以以图形方式分析包依赖关系, 并且为此目的存在许多工具。"),Object(p.b)("h4",{className:"__internal",id:"官方分析工具"},"官方分析工具",Object(p.b)("a",b({parentName:"h4"},{href:"#%E5%AE%98%E6%96%B9%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("img",b({parentName:"p"},{src:"../../optimiz/official_tool.webp",alt:"官方分析工具"}))),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://github.com/webpack/analyse",target:"_blank"}),"官方分析工具"),"会为您提供建议, 并为您的应用程序的依赖关系图提供一个好主意。它也可以在本地运行。"),Object(p.b)("h4",{className:"__internal",id:"webpack-xray"},"webpack-xray",Object(p.b)("a",b({parentName:"h4"},{href:"#webpack-xray","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://github.com/akx/webpack-xray",target:"_blank"}),"webpack-xray")," 与官方分析工具相似, 同时具有现代化的 ",Object(p.b)("inlineCode",{parentName:"p"},"UI")," 并支持对数据的追溯。"),Object(p.b)("h4",{className:"__internal",id:"stellar-webpack"},"Stellar Webpack",Object(p.b)("a",b({parentName:"h4"},{href:"#stellar-webpack","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("img",b({parentName:"p"},{src:"../../optimiz/stellar_webpack.webp",alt:"Stellar Webpack"}))),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://alexkuz.github.io/stellar-webpack/",target:"_blank"}),"Stellar Webpack")," 提供基于 ",Object(p.b)("inlineCode",{parentName:"p"},"Universe")," 的可视化界面, 并允许您以 ",Object(p.b)("inlineCode",{parentName:"p"},"3D")," 形式检查应用程序。"),Object(p.b)("h4",{className:"__internal",id:"webpack-deps-tree"},"webpack-deps-tree",Object(p.b)("a",b({parentName:"h4"},{href:"#webpack-deps-tree","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://restrry.github.io/webpack-deps-tree/static/",target:"_blank"}),"webpack-deps-tree")," 显示 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 模块图。使用该工具, 您可以了解捆绑软件的模块之间如何相互关联。"),Object(p.b)("h4",{className:"__internal",id:"circular-dependency-plugin"},"circular-dependency-plugin",Object(p.b)("a",b({parentName:"h4"},{href:"#circular-dependency-plugin","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/circular-dependency-plugin",target:"_blank"}),"circular-dependency-plugin")," 可让您检测模块图中的循环。通常, 这意味着存在错误, 并且重构循环可能是一个好主意。"),Object(p.b)("h4",{className:"__internal",id:"dependency-cruiser"},"dependency-cruiser",Object(p.b)("a",b({parentName:"h4"},{href:"#dependency-cruiser","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/dependency-cruiser",target:"_blank"}),"dependency-cruiser")," 是用于分析项目依赖关系的独立于捆绑程序的工具。"),Object(p.b)("h4",{className:"__internal",id:"madge"},"madge",Object(p.b)("a",b({parentName:"h4"},{href:"#madge","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("img",b({parentName:"p"},{src:"../../optimiz/madge.webp",alt:"madge"}))),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/madge",target:"_blank"}),"madge")," 是另一个可以根据模块输入进行图形输出的独立工具。图形输出使您可以更详细地了解项目的依赖关系。"),Object(p.b)("h3",{className:"__internal",id:"成分分析"},"成分分析",Object(p.b)("a",b({parentName:"h3"},{href:"#%E6%88%90%E5%88%86%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"饼图, 树形图和命令行工具可让您可视化捆绑包的组成。研究生成的图形可以有效了解整个捆绑包的组成, 并了解是什么影响的捆绑包大小。"),Object(p.b)("h4",{className:"__internal",id:"饼状图"},"饼状图",Object(p.b)("a",b({parentName:"h4"},{href:"#%E9%A5%BC%E7%8A%B6%E5%9B%BE","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("img",b({parentName:"p"},{src:"../../optimiz/pie_charts.webp",alt:"webpack 可视化工具"}))),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://chrisbateman.github.io/webpack-visualizer/",target:"_blank"}),"Webpack Visualizer")," 提供了一个饼状图, 显示了包的组成, 从而可以了解哪些依赖项会影响整体结果的大小。",Object(p.b)("a",b({parentName:"p"},{href:"https://alexkuz.github.io/webpack-chart/",target:"_blank"}),"Webpack Chart")," 是另一个类似的选项。"),Object(p.b)("p",null,"除了提供饼图可视化之外, ",Object(p.b)("a",b({parentName:"p"},{href:"http://auxpack.com/",target:"_blank"}),"Auxpack")," 还可以跟踪随时间变化的捆绑包大小。"),Object(p.b)("h4",{className:"__internal",id:"树状图"},"树状图",Object(p.b)("a",b({parentName:"h4"},{href:"#%E6%A0%91%E7%8A%B6%E5%9B%BE","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("img",b({parentName:"p"},{src:"../../optimiz/webpack_bundle_analyzer.webp",alt:"webpack-bundle-analyzer"}))),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-bundle-analyzer",target:"_blank"}),"webpack-bundle-analyzer")," 提供了可缩放的树状图。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"http://webpackmonitor.com/",target:"_blank"}),"Webpack Monitor")," 是另一个类似的工具, 其重点是清晰的用户界面。能够提供有关改进构建的建议。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/source-map-explorer",target:"_blank"}),"source-map-explorer")," 是一个独立于 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的工具。它使您可以使用源映射来深入了解自己的构建。它提供了一个基于树形图的可视化效果, 显示了哪些代码有助于结果。",Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/bundle-wizard",target:"_blank"}),"bundle-wizard")," 是另一个类似的工具。"),Object(p.b)("h4",{className:"__internal",id:"命令行程序"},"命令行程序",Object(p.b)("a",b({parentName:"h4"},{href:"#%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A8%8B%E5%BA%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/webpack-bundle-size-analyzer",target:"_blank"}),"webpack-bundle-size-analyzer")," 提供了基于文本的组成展示。"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(p.b)("pre",b({parentName:"div"},{className:"language-bash"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-bash"}),"$ webpack-bundle-size-analyzer stats.json\nreact: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"93.99")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"74.9"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\npurecss: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"15.56")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"12.4"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\nstyle-loader: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"6.99")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"5.57"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\nfbjs: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"5.02")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"4.00"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\nobject-assign: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"1.95")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"1.55"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\ncss-loader: ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"1.47")," KB ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"1.17"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"<"),"self",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),">"),": ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"572")," B ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"0.445"),"%",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")")))),Object(p.b)("h3",{className:"__internal",id:"在线服务"},"在线服务",Object(p.b)("a",b({parentName:"h3"},{href:"#%E5%9C%A8%E7%BA%BF%E6%9C%8D%E5%8A%A1","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"通过使用 ",Object(p.b)("a",b({parentName:"p"},{href:"https://www.bundle-analyzer.com/",target:"_blank"}),"Bundle Analyzer"),"(免费)和 ",Object(p.b)("a",b({parentName:"p"},{href:"https://packtracker.io/",target:"_blank"}),"Packtracker"),"(商业), 可以将 ",Object(p.b)("inlineCode",{parentName:"p"},"bundle")," 分析集成到您的构建过程中。该服务与 ",Object(p.b)("inlineCode",{parentName:"p"},"GitHub")," 集成良好, 并将显示在您的拉取请求中, 因为在此可见信息非常有价值。"),Object(p.b)("h3",{className:"__internal",id:"捆绑包比较"},"捆绑包比较",Object(p.b)("a",b({parentName:"h3"},{href:"#%E6%8D%86%E7%BB%91%E5%8C%85%E6%AF%94%E8%BE%83","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/@mixer/webpack-bundle-compare",target:"_blank"}),"@mixer/webpack-bundle-compare")," 允许您通过用户界面比较随时间变化的包大小。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://github.com/smikula/webpack-bundle-diff",target:"_blank"}),"webpack-bundle-diff")," 在较低级别上运行, 并发出带有差异的 ",Object(p.b)("inlineCode",{parentName:"p"},"JSON")," 文件。它与自定义可视化效果很好。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://github.com/GoogleChromeLabs/size-plugin",target:"_blank"}),"size-plugin")," 打印出自上次构建以来的大小差异, 这在本地开发中可能很有用。"),Object(p.b)("h3",{className:"__internal",id:"未使用文件分析"},"未使用文件分析",Object(p.b)("a",b({parentName:"h3"},{href:"#%E6%9C%AA%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/unused-webpack-plugin",target:"_blank"}),"unused-webpack-plugin")," 能够发现 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 构建未使用但包含在项目中的文件。",Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/remnants",target:"_blank"}),"remnants")," 是一个超越 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的解决方案, 也可以与其他工具一起使用。"),Object(p.b)("h3",{className:"__internal",id:"重复分析"},"重复分析",Object(p.b)("a",b({parentName:"h3"},{href:"#%E9%87%8D%E5%A4%8D%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"除了 ",Object(p.b)("inlineCode",{parentName:"p"},"inspectpack")," 外, 还有其他工具可以找出重复项:"),Object(p.b)("ul",null,Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("a",b({parentName:"li"},{href:"https://www.npmjs.com/package/bundle-duplicates-plugin",target:"_blank"}),"bundle-duplicates-plugin")," 在功能级别上运行。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("a",b({parentName:"li"},{href:"https://www.npmjs.com/package/find-duplicate-dependencies",target:"_blank"}),"find-duplicate-dependencies")," 在 ",Object(p.b)("inlineCode",{parentName:"li"},"npm")," 软件包级别上实现了相同的目的。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("a",b({parentName:"li"},{href:"https://www.npmjs.com/package/depcheck",target:"_blank"}),"depcheck")," 会走得更远, 并在项目中存在冗余依赖项或缺少依赖项时发出警告。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("a",b({parentName:"li"},{href:"https://www.npmjs.com/package/bundle-buddy",target:"_blank"}),"bundle-buddy")," 可以在捆绑之间找到重复项, 同时提供用户界面来调整 ",Object(p.b)("inlineCode",{parentName:"li"},"webpack")," 代码拆分行为。",Object(p.b)("a",b({parentName:"li"},{href:"https://www.npmjs.com/package/bundle-buddy-webpack-plugin",target:"_blank"}),"bundle-buddy-webpack-plugin")," 使其更易于使用。")),Object(p.b)("p",null,"如果它在您的构建中多次发现单个软件包, 则 ",Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/duplicate-package-checker-webpack-plugin",target:"_blank"}),"duplicate-package-checker-webpack-plugin")," 会警告您。否则很难发现这种情况。"),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/inspectpack",target:"_blank"}),"inspectpack")," 可用于找出要改进的代码的特定位置。下面的示例执行重复分析:"),Object(p.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(p.b)("pre",b({parentName:"div"},{className:"language-bash"}),Object(p.b)("code",b({parentName:"pre"},{className:"language-bash"}),"$ inspectpack --action",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"="),"duplicates --bundle",Object(p.b)("span",b({parentName:"code"},{className:"token operator"}),"="),"bundle.js\n",Object(p.b)("span",b({parentName:"code"},{className:"token comment"}),"## Summary"),"\n\n* Bundle:\n    * Path:                /",Object(p.b)("span",b({parentName:"code"},{className:"token environment constant"}),"PATH"),"/TO/bundle.js\n    * Bytes ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"min",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),":         ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"1678533"),"\n* Missed Duplicates:\n    * Num Unique Files:    ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"116"),"\n    * Num Extra Files:     ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"131"),"\n    * Extra Bytes ",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),"("),"min",Object(p.b)("span",b({parentName:"code"},{className:"token punctuation"}),")"),":   ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"253955"),"\n    * Pct of Bundle Size:  ",Object(p.b)("span",b({parentName:"code"},{className:"token number"}),"15")," %"))),Object(p.b)("p",null,"该工具还带有一个插件, 您可以将其直接附加到配置中, 以防您希望在构建过程中执行检查。"),Object(p.b)("h3",{className:"__internal",id:"了解模块捆绑的原因"},"了解模块捆绑的原因",Object(p.b)("a",b({parentName:"h3"},{href:"#%E4%BA%86%E8%A7%A3%E6%A8%A1%E5%9D%97%E6%8D%86%E7%BB%91%E7%9A%84%E5%8E%9F%E5%9B%A0","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,Object(p.b)("a",b({parentName:"p"},{href:"https://www.npmjs.com/package/whybundled",target:"_blank"}),"whybundled")," 旨在回答为什么捆绑包中包含特定模块的问题。"),Object(p.b)(m,b({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(p.b)("p",{parentName:"MdAlert"},Object(p.b)("inlineCode",{parentName:"p"},"--display-reasons")," 标志也会提供更多信息。范例: ",Object(p.b)("inlineCode",{parentName:"p"},"npm run build -- --display-reasons"),"。另一种选择是设置 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 配置 ",Object(p.b)("inlineCode",{parentName:"p"},"stats.reasons")," 为 ",Object(p.b)("inlineCode",{parentName:"p"},"true"),"。")),Object(p.b)("h3",{className:"__internal",id:"结论"},"结论",Object(p.b)("a",b({parentName:"h3"},{href:"#%E7%BB%93%E8%AE%BA","aria-hidden":!0,className:"anchor"}),"#")),Object(p.b)("p",null,"当您优化捆绑输出的大小时, 这些工具是无价的。官方工具具有最多的功能, 但即使是基本的可视化也可以发现问题点。您可以对旧项目使用相同的技术来了解其组成。"),Object(p.b)("p",null,"回顾一下:"),Object(p.b)("ul",null,Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),Object(p.b)("inlineCode",{parentName:"li"},"Webpack")," 允许您提取包含有关构建信息的 ",Object(p.b)("inlineCode",{parentName:"li"},"JSON")," 文件。数据可以包括构建组成和时间安排。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"可以使用各种工具对生成的数据进行分析, 这些工具可以洞悉各个方面, 例如捆绑包的组成。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"性能预算允许您设置构建大小的限制。维持预算可以使开发人员更了解生成的捆绑包的大小。"),Object(p.b)("li",b({parentName:"ul"},{className:"__internal"}),"了解捆绑包是优化整体大小, 加载内容和时间的关键。它还可以揭示更重要的问题, 例如冗余数据。")),Object(p.b)("p",null,"在下一章中, 您将学习调整 ",Object(p.b)("inlineCode",{parentName:"p"},"webpack")," 的性能。"))}N.isMDXComponent=!0,N=Object(c.hot)(e)(N),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(r.register(l,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Optimizing/build-analysis.md"),r.register(m,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Optimizing/build-analysis.md"),r.register(i,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Optimizing/build-analysis.md"),r.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Optimizing/build-analysis.md"),r.register(N,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Optimizing/build-analysis.md")),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&o(e)}.call(this,n(21)(e))}}]);