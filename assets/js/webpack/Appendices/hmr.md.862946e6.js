(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{133:function(e,a,t){"use strict";t.r(a),function(e){t.d(a,"default",(function(){return d}));var n,o=t(86),c=(t(127),t(0),t(87));function r(){return(r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function p(e,a){if(null==e)return{};var t,n,o=function(e,a){if(null==e)return{};var t,n,o={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s,b,l=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(c.b)("div",a)}},m=l("MdAlert"),i={};function d(e){var a=e.components,t=p(e,["components"]);return Object(c.b)("wrapper",r({},i,t,{components:a,mdxType:"MDXLayout"}),Object(c.b)("h2",{className:"__internal",id:"模块热更新"},"模块热更新",Object(c.b)("a",r({parentName:"h2"},{href:"#%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0","aria-hidden":!0,className:"anchor"}),"#")),Object(c.b)("p",null,"模块热更新(",Object(c.b)("inlineCode",{parentName:"p"},"HMR"),")建立在 ",Object(c.b)("inlineCode",{parentName:"p"},"WDS")," 之上。它启用了一个接口, 可以实时交换模块。例如, 样式加载器可以在不强制刷新的情况下更新 ",Object(c.b)("inlineCode",{parentName:"p"},"CSS"),"。为样式实现 ",Object(c.b)("inlineCode",{parentName:"p"},"HMR")," 是理想的, 因为 ",Object(c.b)("inlineCode",{parentName:"p"},"CSS")," 在设计上是无状态的。"),Object(c.b)("p",null,"在 ",Object(c.b)("inlineCode",{parentName:"p"},"JavaScript")," 也可以使用 ",Object(c.b)("inlineCode",{parentName:"p"},"HMR"),", 但是由于应用程序状态, 因此它更加难以实现。",Object(c.b)("a",r({parentName:"p"},{href:"https://www.npmjs.com/package/react-refresh-webpack-plugin",target:"_blank"}),"react-refresh-webpack-plugin")," 和 ",Object(c.b)("a",r({parentName:"p"},{href:"https://www.npmjs.com/package/vue-hot-reload-api",target:"_blank"}),"vue-hot-reload-api")," 是很好的例子。"),Object(c.b)(m,r({message:" ",type:"info"},{mdxType:"MdAlert"}),Object(c.b)("p",{parentName:"MdAlert"},"鉴于 ",Object(c.b)("inlineCode",{parentName:"p"},"HMR")," 实现起来可能很复杂, 一个不错的折衷方案是将应用程序状态存储到 ",Object(c.b)("mark",null,"localStorage"),", 刷新后根据该状态对应用程序进行补充。这样做会将问题推到应用程序端。")),Object(c.b)("h3",{className:"__internal",id:"启用-hmr"},"启用 HMR",Object(c.b)("a",r({parentName:"h3"},{href:"#%E5%90%AF%E7%94%A8-hmr","aria-hidden":!0,className:"anchor"}),"#")),Object(c.b)("p",null,"要启用 ",Object(c.b)("inlineCode",{parentName:"p"},"HMR"),", 需要启用以下步骤:"),Object(c.b)("ul",null,Object(c.b)("li",r({parentName:"ul"},{className:"__internal"}),"开发服务器必须在热模式下运行, 才能将热模块替换界面公开给客户端。"),Object(c.b)("li",r({parentName:"ul"},{className:"__internal"}),Object(c.b)("inlineCode",{parentName:"li"},"Webpack")," 必须提供服务器的热更新, 并且可以使用 ",Object(c.b)("mark",null,"webpack.HotModuleReplacementPlugin")," 来实现。"),Object(c.b)("li",r({parentName:"ul"},{className:"__internal"}),"客户端必须运行开发服务器提供的特定脚本。它们将自动注入, 但可以通过入口配置显式启用。"),Object(c.b)("li",r({parentName:"ul"},{className:"__internal"}),"客户端必须通过 ",Object(c.b)("mark",null,"module.hot.accept")," 来实现 ",Object(c.b)("inlineCode",{parentName:"li"},"HMR")," 接口, 并有选择 ",Object(c.b)("mark",null,"module.hot.dispose")," 清理模块, 然后才可以进行替换。")),Object(c.b)("p",null,"以模式使用webpack-dev-server --hot或运行webpack-plugin-servehot可解决前两个问题。在这种情况下, 如果要修补JavaScript应用程序代码, 则只需自己处理最后一个。跳过--hot标志并进行webpack配置可提供更大的灵活性。"),Object(c.b)("p",null,"以下清单包含与此方法有关的基本部分。您必须从此处进行调整以匹配您的配置样式:"),Object(c.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(c.b)("pre",r({parentName:"div"},{className:"language-js"}),Object(c.b)("code",r({parentName:"pre"},{className:"language-js"}),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"{"),"\n  devServer",Object(c.b)("span",r({parentName:"code"},{className:"token operator"}),":")," ",Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// Don't refresh if hot loading fails. Good while"),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// implementing the client interface."),"\n    hotOnly",Object(c.b)("span",r({parentName:"code"},{className:"token operator"}),":")," ",Object(c.b)("span",r({parentName:"code"},{className:"token boolean"}),"true"),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),","),"\n\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// If you want to refresh on errors too, set"),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// hot: true,"),"\n  ",Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"}"),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),","),"\n  plugins",Object(c.b)("span",r({parentName:"code"},{className:"token operator"}),":")," ",Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// Enable the plugin to let webpack communicate changes"),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token comment"}),"// to WDS. --hot sets this automatically!"),"\n    ",Object(c.b)("span",r({parentName:"code"},{className:"token keyword"}),"new")," ",Object(c.b)("span",r({parentName:"code"},{className:"token class-name"}),"webpack",Object(c.b)("span",r({parentName:"span"},{className:"token punctuation"}),"."),"HotModuleReplacementPlugin"),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),")"),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"]"),Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(c.b)("span",r({parentName:"code"},{className:"token punctuation"}),"}")))))}d.isMDXComponent=!0,d=Object(o.hot)(e)(d),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(l,"makeShortcode","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Appendices/hmr.md"),s.register(m,"MdAlert","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Appendices/hmr.md"),s.register(i,"layoutProps","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Appendices/hmr.md"),s.register("wrapper","MDXLayout","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Appendices/hmr.md"),s.register(d,"MDXContent","/Users/yuzhoujie/Desktop/work/webpack-book-china/docs/webpack/Appendices/hmr.md")),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&b(e)}.call(this,t(21)(e))}}]);